<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>í”„ë¡œë¯¸ìŠ¤</title>
  </head>
  <body>
    <script>
      //ê³µê³µapi -> íŠ¹ì •í•œ ì‹œê°„ì— jsë¥¼ ì‹¤í–‰í•´ì„œ ë°ì´í„°ë¥¼ dbì— insert

      /* promise ê°ì²´: ì²˜ë¦¬ì— ì„±ê³µì‹œ ì‹¤í–‰í•  ì½œë°±í•¨ìˆ˜
                         ì²˜ë¦¬ì— ì„±ê³µí•˜ì§€ ì•Šì•˜ì„ ë•Œ ì‹¤í–‰í•  ì½œë°±í•¨ìˆ˜ë¥¼
                         ë¯¸ë¦¬ ì•½ì†
      */
      //resolve: ì„±ê³µì‹œ ì‹¤í–‰
      //reject: ì‹¤íŒ¨ì‹œ ì‹¤í–‰

      //Producer & Consumer
      //promise ê°ì²´ ìƒì„±
      const promise = new Promise((resolve, reject) => {
        setTimeout(() => {
          //   resolve("ì„±ê³µ");
          reject(new Error("ì‹¤íŒ¨"));
        }, 2000);
      });

      /* errì™€ ê´€ë ¨ëœ log db - log */

      //consumer: promise ê°€ì ¸ë‹¤ê°€ ì‹¤í–‰
      //then(): ì‹¤í–‰ ì„±ê³µ
      //catch(): ì‹¤í–‰ ì‹¤íŒ¨
      //finaly(): ë¬´ì¡°ê±´ ë§ˆì§€ë§‰ì— íƒ€ëŠ” ë¶€ë¶„
      promise
        .then((res) => {
          console.log(res);
        })
        .catch((err) => {
          console.log(err);
        })
        .finally(() => {
          console.log("ìµœì¢…!");
        });

      //promise ì²´ì´ë‹
      const fetchNumber = new Promise((res, rej) => {
        setTimeout(() => res(1), 1000);
      });
      //then() ì˜ì—­ì—ëŠ” ê°’, promise ê°ì²´ë„ ì „ë‹¬
      fetchNumber
        .then((num) => num * 2)
        .then((num) => num * 3)
        .then((num) => {
          return new Promise((res, rej) => {
            setTimeout(() => res(num), 1000);
          });
        })
        .then((res) => {
          console.log(res);
        });

      /* error í•¸ë“¤ë§ */
      const getHen = () => {
        return new Promise((res, rej) => {
          setTimeout(() => res("ðŸ”"), 1000);
        });
      };
      const getEgg = (hen) => {
        return new Promise((res, rej) => {
          setTimeout(() => res(`${hen} => ðŸ¥š`), 1000);
          //   setTimeout(() => rej(`error! ${hen} => ðŸ¥š`), 1000);
        });
      };
      const getCook = (egg) => {
        return new Promise((res, rej) => {
          setTimeout(() => res(`${egg} => ðŸ³`), 1000);
        });
      };

      getHen() //promise ê°ì²´ê°€ ë°˜í™˜
        .then((hen) => getEgg(hen))
        // .catch((err) => {
        //   return "ðŸŽƒ";
        // })
        .then((egg) => getCook(egg))
        .then((meal) => console.log(meal));

      //   getHen().then(getEgg).then(getCook).then(console.log);
    </script>
  </body>
</html>
